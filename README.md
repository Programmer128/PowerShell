# PowerShell
PowerShell Scripts for Active Directory or File Systems

The Move-GroupsByMembersDepartmentExample.ps1 is an Active Directory group reorganization script. It goes through all the groups in a domain, finds employee, student, computer, empty, and other groups, such as ones with all disabled members, and moves them into Active Directory Organizational Units based on Division OU/Department OU. System groups are identified and left in place.
The OU a groups is moved to is based on the department with the most members in the group. Groups with members from more than 3 departments are moved to an OU at the Division level. Which division OU they are moved to is based on which division has the most members in the group. Empty groups are moved to a single OU set up for that purpose. Groups with a majority of student members are also moved to a Students groups OU. Division organizational units and child department OUs are created on the fly if they do not exist before the first group is moved into them.

The Get-SharePermissions.ps1 script iterates through a server's shared folders and their subfolders and writes ACL information to file. A PSObject is used to keep track of the share path/group name/permissions information.

The Set-GroupDescriptionsFromFile.ps1 reads a CSV file with data on server shares ACLs, and always writes the UNC path of the first share found in the file to which a group has access to the file. This file will be used by a second script to write UNC share paths that are accessible by an Active Directory group to the group's description attribute. If there are other shares the group has access to then those are written, one UNC path per line, to the file also. The second follow-up script will write the second and later UNC share paths for the group to the group's notes attribute. Since the notes attribute has a 1024 character limit, the script keeps track of the number of characters that will be written to the notes attribute and stops writing group share access information to file if an UNC path would exceed that character limit.
The second script reads this resulting file and writes the shared folder UNC path data to all the groups' description and notes attributes. 
